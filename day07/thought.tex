\documentclass[a4paper,11pt]{article}

\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage[hmargin=1.5cm,vmargin=1.8cm]{geometry}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathtools}

\begin{document}
This puzzle actually has a direct answer to it (for both parts) but it is
funnier to write a crab function (that moves along a function with a minimum).

That being said, it is still interesting to see why it does have a direct
answer, and doing so seeing how the crab function works and find a global
optimum (otherwise the crab function may find ``wrong one'' or even loop
indefinitely because there are no optimum).


\section{General form of the problem}

The configuration of the problem is a set of (one-dimensional) points 
$(P_i)_{0 \leq i \leq n}$, representing the abscissa of the crabs. The goal is
to find the point $X$ that minimizes some cost function (the quantity of fuel
needed by the crab submarine at position $P_i$ to reach position $X$).

The cost for crab $i$ to go from its position to $X$ is denoted $c(P_i,X)$ (it
is the same for every crab). The total cost is thus:
\begin{equation}
\mathcal{C}(X) = \sum_{i = 0}^n c(P_i, X)
\end{equation}

\noindent and thus the general form of the problem is:
\begin{equation}
\min_X \mathcal{C}(X) = \min_X \sum_{i = 0}^n c(P_i, X)
\end{equation}

In the following, we will consider that the positions are ordered (this does not
change the solution of the problem and makes everything very much easier):
$$P_0 \leq P_1 \leq \ldots \leq P_{n - 1} \leq P_n$$


\section{First case}

In the first case, the cost function is:
\begin{equation}
\forall i, c(P_i, X) = |P_i - X|
\end{equation}

\noindent so the total cost function is:
\begin{equation}
\mathcal{C}(X) = \sum_{i = 0}^n |P_i - X|
\end{equation}

Let us try to find an optimum to this function. For that, we note that
$\mathcal{C}$ is continuous, and piecewise differentiable (on intervals of the
form $[P_i, P_{i + 1}]$.

Let us calculate the derivative of each cost function:
\begin{equation}
\frac{\mathrm{d} c(P_i, X)}{\mathrm{d} X} = \left\{
\begin{array}{lcl}
-1 & & \text{if}~P_i > X \\
1 & & \text{if}~P_i < X \\
0 & & \text{if}~P_i = X
\end{array}
\right.
\end{equation}

Let us consider $\exists k \in [0,n], P_0 \leq \ldots \leq P_k \leq X \leq P_{k+1} \leq \ldots \leq P_n$,
and let us calculate the derivative of the cost function:
\begin{equation}
\frac{\mathrm{d}\mathcal{C}(X)}{\mathrm{d}X}
\end{equation}


\end{document}




